Level 2 Practice: Using Macro Conditional Processing in Open Code


1.Reminder: If you restarted your SAS session, you must submit the libname.sas program in the EMC1V2 folder to 
access your practice files. 

Open m104p08.sas from the practices folder. Run the program and verify that a table named Profit was created in 
the work library, and that a bar chart was produced.

Add a LIBNAME statement to create a library named Orion that points to the practices folder in the course files.
Use the path "&path/practices".

Add a %PUT statement to write the value of the automatic macro variable syslibrc to the log. 
If the LIBNAME statement ran successfully, the value of syslibrc is zero. Otherwise, it is a value other than zero.
自動マクロ変数syslibrcの値をログに書き込むための%PUT文を追加する。
LIBNAME文が正常に実行された場合、syslibrcの値は0である。そうでなければ、ゼロ以外の値である。

Run the LIBNAME and %PUT statements.  
LIBNAME文と%PUT文を実行します。 

Modify the CREATE TABLE statement to write the Profit table to the Orion library.
CREATE TABLE文を修正し、ProfitテーブルをOrionライブラリに書き込む。

Add macro conditional statements: If syslibrc is not equal to zero, then write a custom error message 
to the log indicating the rest of the program will not execute because of the failure of the LIBNAME statement. 
If syslibrc is equal to zero, run the PROC SQL and SGPLOT steps.
マクロ条件文を追加する。syslibrcが0に等しくない場合、カスタムエラーメッセージをログに書き込む。
LIBNAME ステートメントの失敗のために、プログラムの残りの部分が実行されないことを示すカスタムエラーメッセージをログに書き込む。
syslibrc がゼロに等しい場合、PROC SQL および SGPLOT ステップを実行します。

Test the program with and without an error in the LIBNAME statement. 
LIBNAME ステートメントにエラーがある場合とない場合で、プログラムをテストします。

If the graph is created successfully, which Product_Category value has the highest sum of Profit?
グラフが正常に作成された場合、Profit の合計が最も高い Product_Category 値はどれですか？

outdoors
正解
Outdoors has the has the highest sum of Profit.

/*
libname orion "&path/practices";
%put &=syslibrc;

%if &syslibrc ne 0 %then %do;
    %put ERROR: Because of the error in the LIBNAME statement, the rest of the program will not execute.;
%end;

%else %do;
    proc sql;
    create table orion.profit as
    select o.product_id, Product_Name, Product_Category,  
           (Total_Retail_Price-(CostPrice_per_Unit*Quantity)) 
	          as Profit format=dollar12.2 
        from mc1.orders as o inner join mc1.products as p 
        on o.product_id=p.product_id;
    quit;
	
    proc sgplot data=orion.profit noautolegend;
        hbar Product_Category / response=Profit fillType=gradient 
                                categoryorder=respdesc;
    run;
%end;
*/

