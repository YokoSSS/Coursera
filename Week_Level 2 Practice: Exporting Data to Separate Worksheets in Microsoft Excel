1.Reminder: If you restarted your SAS session, you must submit the libname.sas program in the EMC1V2 folder. 

Open m105p02.sas from the practices folder. Review and submit the program. 
practices フォルダにある m105p02.sas を開いてください。プログラムを確認し、提出する。

In the course data folder, select the NAStorms.xlsx file, and click the Download icon. 
Confirm storms from the NA basin are included and close the Excel file after viewing it.  
コースデータフォルダ内のNAStorms.xlsxファイルを選択し、ダウンロードアイコンをクリックします。
NA流域の暴風雨が含まれていることを確認し、閲覧後Excelファイルを閉じます

Create a macro named BasinXLS that writes storms for each distinct value of Basin to a different worksheet in an Excel workbook named BasinStorms.xlsx. 
Include the following logic in the macro program:  
BasinStorms.xlsx という名前の Excel ワークブック内の別のワークシートに、Basin の異なる値ごとに嵐を書き込む BasinXLS という名前のマクロを作成する。
マクロプログラムに以下のロジックを含めよ。 

Use the automatic macro variable Syslibrc to verify whether the LIBNAME statement runs successfully (SYSLIBRC=0). 
If it does not run successfully (SYSLIBRC≠0), write a custom error message to the log and terminate macro execution.
自動マクロ変数Syslibrcを使用して、LIBNAME文が正常に実行されるかどうかを確認する(SYSLIBRC=0)。
正常に実行されない場合（SYSLIBRC≠0）、独自のエラーメッセージをログに書き込み、マクロの実行を終了させる。

Create a numbered series of macro variables for each value of Basin and BasinName in the mc1.storm_basin_codes table. 
Remove all spaces from the BasinName values before assigning them to macro variables.
mc1.storm_basin_codesテーブルのBasinとBasinNameの各値に対して、番号付きの一連のマクロ変数を作成する。
BasinNameの値からすべてのスペースを削除してから、マクロ変数に代入する。

Use a macro %DO loop to repeat the DATA step for each value of Basin.
マクロ%DOループを使用して、Basinの各値に対してDATAステップを繰り返します。

Call the %BasinXLS macro and open the BasinStorms.xlsx file. Confirm that six worksheets are included.
BasinXLS マクロを呼び出し、BasinStorms.xlsx ファイルを開きます。6 つのワークシートが含まれていることを確認します。

What is the name of the first storm listed in the SouthIndian_Storms worksheet?  
SouthIndian_Storms ワークシートにリストされている最初の嵐の名前は何ですか?  

1点
My answer:

ALFRED
正解
Solution code:

%macro basinxls;
libname storm xlsx "&path/basinstorms.xlsx";
%if &syslibrc ne 0 %then %do;
    %put ERROR: BasinStorms.xlsx was not successfully assigned. Check the path and filename.;
%end;

%else %do;
    proc sql noprint;
    select Basin, compress(BasinName)
        into :basin1-, :basinname1-
	   from mc1.storm_basin_codes;
    quit;
	
    %do i=1 %to &sqlobs;
    data storm.&&basinname&i.._Storms;
        set mc1.storm_final;
        where Basin="&&basin&i";
    run;
    %end;
%end;
libname storm clear;
%mend basinxls;


If the code does not work, search the STORM_FINAL table in My Library in the library. Or download and check it.

